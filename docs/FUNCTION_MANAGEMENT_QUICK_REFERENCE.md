---
draft: true
---
# Croupier å‡½æ•°ç®¡ç†ç³»ç»Ÿ - å¿«é€Ÿå‚è€ƒæŒ‡å—

## å…³é”®è¦ç‚¹ (30 ç§’é€Ÿè§ˆ)

| é—®é¢˜ | å½“å‰çŠ¶æ€ | å»ºè®®æ”¹è¿› | ä¼˜å…ˆçº§ |
|-----|---------|---------|--------|
| èœå•ç»“æ„ | å‡½æ•°åŠŸèƒ½åˆ†æ•£åœ¨ 2 ä¸ªèœå•ä¸‹ | ç»Ÿä¸€ä¸º"å‡½æ•°ç®¡ç†"èœå• | é«˜ |
| é¡µé¢è®¾è®¡ | GmFunctions å•é¡µé¢ 650+ è¡Œä»£ç  | æ‹†åˆ†ä¸º 5 ä¸ªä¸“æ³¨é¡µé¢ | ä¸­ |
| æƒé™æ¨¡å‹ | ç²—ç²’åº¦ï¼ˆfunctions:read ç­‰ï¼‰ | ç»†ç²’åº¦ï¼ˆfunction:{id}:invoke ç­‰ï¼‰ | ä¸­ |
| æ•°æ®æµ | å¤šé¡µé¢ç‹¬ç«‹åŠ è½½ï¼Œæ— ç¼“å­˜ | å…¨å±€ Context + å…±äº«ç¼“å­˜ | ä½-ä¸­ |

---

## æ–°èœå•ç»“æ„é€Ÿè§ˆ

```
å‡½æ•°ç®¡ç† (FunctionManagement) â† æ–°å¢ç»Ÿä¸€èœå•
â”œâ”€ å‡½æ•°ç›®å½• (Catalog)        â† æœç´¢ã€æµè§ˆã€ç‰ˆæœ¬ç®¡ç†
â”œâ”€ å‡½æ•°è°ƒç”¨ (Invoke)         â† é‡æ„çš„ GmFunctions
â”œâ”€ å‡½æ•°åˆ†é… (Assignments)    â† å¢å¼ºçš„åˆ†é…ç®¡ç†
â”œâ”€ å®ä¾‹ç®¡ç† (Instances)      â† ä» Registry æ‹†åˆ†
â””â”€ å‡½æ•°åŒ… (Packs)            â† å¢å¼ºçš„åŒ…ç®¡ç†
```

---

## 5 ä¸ªæ–°é¡µé¢æ¦‚è§ˆ

### 1ï¸âƒ£ å‡½æ•°ç›®å½• (Catalog)
**ç›®çš„ï¼š** å‘ç°å’Œæµè§ˆå‡½æ•°
```
æœç´¢ + åˆ†ç±» + ç‰ˆæœ¬ + çŠ¶æ€
      â†“
åˆ—è¡¨/å¡ç‰‡/è¯¦æƒ…è§†å›¾
      â†“
å¿«é€Ÿæ“ä½œï¼š[è°ƒç”¨] [åˆ†é…]
```

**å…³é”®åŠŸèƒ½ï¼š**
- å…¨æ–‡æœç´¢ï¼ˆåç§°ã€æè¿°ã€åˆ†ç±»ï¼‰
- é«˜çº§è¿‡æ»¤ï¼ˆç‰ˆæœ¬ã€çŠ¶æ€ã€å®ä¾‹æ•°ï¼‰
- ä¸‰è§†å›¾åˆ‡æ¢
- æ‰¹é‡æ“ä½œ

---

### 2ï¸âƒ£ å‡½æ•°è°ƒç”¨ (Invoke) 
**ç›®çš„ï¼š** æ‰§è¡Œå‡½æ•°
```
é€‰æ‹©å‡½æ•° + å¡«å‚æ•° + è°ƒç”¨ + æŸ¥çœ‹ç»“æœ
                           + å†å²è®°å½•
```

**å…³é”®åŠŸèƒ½ï¼š**
- å‚æ•°è¡¨å•ï¼ˆç®€åŒ–/é«˜çº§æ¨¡å¼ï¼‰
- è°ƒç”¨å†å²é›†æˆ
- ç»“æœå±•ç¤ºï¼ˆè‡ªå®šä¹‰ rendererï¼‰
- é‡æ–°è¿è¡ŒåŠŸèƒ½

---

### 3ï¸âƒ£ å®ä¾‹ç®¡ç† (Instances)
**ç›®çš„ï¼š** Agent å’Œè¦†ç›–ç‡ç®¡ç†
```
Agent åˆ—è¡¨ â†’ å®ä¾‹åˆ†å¸ƒ â†’ è¦†ç›–ç‡åˆ†æ
         â†“
    å¥åº·æ£€æŸ¥ â†’ å‘Šè­¦ â†’ æ‰¹é‡æ“ä½œ
```

**å…³é”®åŠŸèƒ½ï¼š**
- Agent ç”Ÿå‘½å‘¨æœŸç®¡ç†
- è¦†ç›–ç‡è¡¨æ ¼ + å¯è§†åŒ–
- å¥åº·æ£€æŸ¥å’Œå‘Šè­¦
- CSV å¯¼å‡º

---

### 4ï¸âƒ£ å‡½æ•°åˆ†é… (Assignments)
**ç›®çš„ï¼š** æƒé™å’Œåˆ†é…ç®¡ç†
```
é€‰æ‹©æ¸¸æˆ/ç¯å¢ƒ â†’ ç¼–è¾‘å‡½æ•°ç™½åå• â†’ è®¾ç½®ç»†ç²’åº¦æƒé™
                                â†“
                    æ·»åŠ è§’è‰²åˆ†é…ã€æ—¶é—´çª—å£ã€å®¡è®¡
```

**å…³é”®åŠŸèƒ½ï¼š**
- åŸºç¡€ç™½åå•
- æŒ‰è§’è‰²åˆ†é…ï¼ˆæ–°å¢ï¼‰
- æ—¶é—´çª—å£æ§åˆ¶ï¼ˆæ–°å¢ï¼‰
- å˜æ›´å†å²ï¼ˆæ–°å¢ï¼‰

---

### 5ï¸âƒ£ å‡½æ•°åŒ… (Packs)
**ç›®çš„ï¼š** åŒ…ç®¡ç†å’Œç‰ˆæœ¬æ§åˆ¶
```
æŸ¥çœ‹æ¸…å• â†’ å¯¼å…¥/å¯¼å‡º â†’ æŸ¥çœ‹åŒ…å†…å®¹
                     â†“
                  ç‰ˆæœ¬å†å² â†’ ç°åº¦å‘å¸ƒ
```

**å…³é”®åŠŸèƒ½ï¼š**
- åŒ…æ¸…å•å±•ç¤º
- å¯¼å…¥å¯¼å‡ºåŠŸèƒ½
- åŒ…å†…å®¹è¯¦æƒ…ï¼ˆæ–°å¢ï¼‰
- ç‰ˆæœ¬å†å²ï¼ˆæ–°å¢ï¼‰
- ç°åº¦å‘å¸ƒï¼ˆæ–°å¢ï¼‰

---

## 5 ä¸ªé€šç”¨ç»„ä»¶

### ç»„ä»¶æ¸…å•

| ç»„ä»¶ | åŠŸèƒ½ | ä¾èµ– |
|-----|------|------|
| **FunctionFormRenderer** | JSONSchema è¡¨å• | Ant Design Form |
| **FunctionListTable** | è¡¨æ ¼ + æœç´¢ + æ’åº | Ant Design Table |
| **RegistryViewer** | æ³¨å†Œè¡¨å±•ç¤º | è‡ªå®šä¹‰ |
| **FunctionCallHistory** | å†å²æ—¶é—´çº¿ | è‡ªå®šä¹‰ |
| **FunctionDetailPanel** | è¯¦æƒ…é¢æ¿ | è‡ªå®šä¹‰ |

### ä½¿ç”¨çŸ©é˜µ

```
           FunctionForm  FunctionList  Registry  History  Detail
Catalog         âœ“            âœ“                            âœ“
Invoke          âœ“            âœ“                    âœ“
Assignments     âœ“            âœ“
Instances                     âœ“            âœ“
Packs                                             âœ“       âœ“
Approvals       âœ“            âœ“
Dashboard                                  âœ“      âœ“       âœ“
```

---

## æ–°å¢ API ç«¯ç‚¹ (10 ä¸ª)

| ç«¯ç‚¹ | ç±»å‹ | ç”¨é€” |
|-----|------|------|
| `/api/functions/summary` | GET | æ±‡æ€»ä¿¡æ¯ï¼ˆä¸€æ¬¡è¯·æ±‚ï¼‰ |
| `/api/function_calls` | GET | æŸ¥è¯¢å†å² |
| `/api/function_calls/{id}` | GET | å•æ¬¡è¯¦æƒ… |
| `/api/function_calls/{id}/rerun` | POST | é‡æ–°è¿è¡Œ |
| `/api/agents` | GET | Agent åˆ—è¡¨ |
| `/api/agents/{id}/functions` | GET | Agent ä¸Šçš„å‡½æ•° |
| `/api/coverage/analysis` | GET | è¦†ç›–ç‡åˆ†æ |
| `/api/packs/{id}/contents` | GET | åŒ…å†…å®¹ |
| `/api/packs/{id}/versions` | GET | ç‰ˆæœ¬å†å² |
| `/api/packs/{id}/canary` | POST | ç°åº¦å‘å¸ƒ |

---

## æ•°æ®æ¨¡å‹æ‰©å±•

### FunctionDescriptor (æ‰©å±•)

```typescript
{
  id: string;
  version: string;
  
  // æ–°å¢ï¼šå…ƒæ•°æ®
  metadata?: {
    category: string;
    tags: string[];
    description: string;
    creator: string;
    created_at: string;
    updated_at: string;
    deprecation_notice?: string;
  };
  
  // æ–°å¢ï¼šè¿è¡Œæ—¶ä¿¡æ¯
  runtime?: {
    instances: number;
    agents: string[];
    last_called?: string;
    success_rate?: number;
    avg_latency_ms?: number;
  };
}
```

### FunctionAssignment (æ‰©å±•)

```typescript
{
  game_id: string;
  env: string;
  functions: string[];              // åŸºç¡€ç™½åå•
  
  role_assignments?: {              // æ–°å¢ï¼šè§’è‰²åˆ†é…
    [role: string]: string[];
  };
  
  time_windows?: {                  // æ–°å¢ï¼šæ—¶é—´æ§åˆ¶
    enabled: string[];
    disabled: string[];
  };
  
  change_history?: Array<{          // æ–°å¢ï¼šå®¡è®¡
    timestamp: string;
    actor: string;
    operation: 'add'|'remove'|'enable'|'disable';
    function_id: string;
  }>;
}
```

---

## å®æ–½ä¸‰é˜¶æ®µ

### ç¬¬ 1 é˜¶æ®µï¼ˆ2-3 å‘¨ï¼‰ - åŸºç¡€è®¾æ–½
- [ ] æ›´æ–°èœå•é…ç½®
- [ ] åˆ›å»º 5 ä¸ªæ–°é¡µé¢ç›®å½•
- [ ] åˆ›å»ºåå‘å…¼å®¹é‡å®šå‘
- [ ] æ–°å¢ 3 ä¸ª API ç«¯ç‚¹

**äº¤ä»˜ï¼šæ–°èœå•ä¸Šçº¿ + åŸºç¡€å‡½æ•°ç›®å½• + å®ä¾‹ç®¡ç†åˆ†ç¦»**

### ç¬¬ 2 é˜¶æ®µï¼ˆ3-4 å‘¨ï¼‰ - æ ¸å¿ƒå¢å¼º
- [ ] é‡æ„ Invoke é¡µé¢
- [ ] é›†æˆè°ƒç”¨å†å² API
- [ ] å¢å¼º Assignments ç®¡ç†
- [ ] å¢å¼º Packs ç®¡ç†

**äº¤ä»˜ï¼šUI é‡æ„å®Œæˆ + å†å²åŠŸèƒ½ä¸Šçº¿ + åˆ†é…å¢å¼º**

### ç¬¬ 3 é˜¶æ®µï¼ˆ1-2 æœˆï¼‰ - é«˜çº§åŠŸèƒ½
- [ ] ç‰ˆæœ¬å¯¹æ¯”å·¥å…·
- [ ] ç»†ç²’åº¦æƒé™å®ç°
- [ ] å¯è§†åŒ–ç›‘æ§
- [ ] æ€§èƒ½ä¼˜åŒ–

**äº¤ä»˜ï¼šå®Œæ•´çš„ç‰ˆæœ¬ç®¡ç† + æƒé™ç³»ç»Ÿ + ç›‘æ§**

---

## è·¯ç”±å˜æ›´

### æ–°è·¯ç”±

```
/functions/catalog          å‡½æ•°ç›®å½•
/functions/invoke           å‡½æ•°è°ƒç”¨
/functions/invoke/:id       è°ƒç”¨è¯¦æƒ…
/functions/assignments      å‡½æ•°åˆ†é…
/functions/instances        å®ä¾‹ç®¡ç†
/functions/packs            å‡½æ•°åŒ…
/functions/:id              å‡½æ•°è¯¦æƒ…
/functions/:id/history      è°ƒç”¨å†å²
/functions/:id/compare      ç‰ˆæœ¬å¯¹æ¯”
```

### æ—§è·¯ç”±é‡å®šå‘

```
/game/functions          â†’ /functions/invoke
/game/assignments        â†’ /functions/assignments
/game/packs              â†’ /functions/packs
/operations/registry     â†’ /functions/instances
```

---

## æƒé™æ‰©å±•

### æ–°æƒé™å®šä¹‰

```
resource ç²’åº¦ï¼š
â”œâ”€ function:{id}:read              è¯»ç‰¹å®šå‡½æ•°
â”œâ”€ function:{id}:invoke            è°ƒç”¨ç‰¹å®šå‡½æ•°
â”œâ”€ function:{id}:view_history      æŸ¥çœ‹å†å²
â”œâ”€ assignments:{game_id}:read      è¯»ç‰¹å®šæ¸¸æˆåˆ†é…
â”œâ”€ assignments:{game_id}:write     ä¿®æ”¹ç‰¹å®šæ¸¸æˆåˆ†é…
â”œâ”€ registry:read                   è¯»æ³¨å†Œè¡¨
â””â”€ packs:manage                    ç®¡ç†åŒ…

è§’è‰²ç»‘å®šï¼š
â”œâ”€ game_operator          è°ƒç”¨å·²åˆ†é…çš„å‡½æ•°
â”œâ”€ game_admin             ä¿®æ”¹åˆ†é…å…³ç³»
â”œâ”€ function_developer     ä¸Šä¼ /æ›´æ–°åŒ…
â”œâ”€ ops_engineer           Registry + Instances
â””â”€ system_admin           å®Œå…¨æƒé™
```

---

## å…³é”®æ•°æ®ç»“æ„

### FunctionManagementState (å‰ç«¯å…¨å±€çŠ¶æ€)

```typescript
{
  // åŸºç¡€
  selectedGame: string;
  selectedEnv: string;
  
  // ç¼“å­˜
  descriptors: Map<string, FunctionDescriptor>;
  assignments: Map<string, string[]>;
  registry: RegistryData;
  agents: Agent[];
  recentCalls: FunctionCall[];
  
  // UI
  searchText: string;
  filters: FunctionFilter;
  viewMode: 'list' | 'grid' | 'detail';
}
```

---

## æ€§èƒ½æŒ‡æ ‡ç›®æ ‡

| æŒ‡æ ‡ | å½“å‰ | ç›®æ ‡ | æ–¹æ³• |
|-----|------|------|------|
| é¡µé¢åŠ è½½æ—¶é—´ | 2s | 1.5s | ç¼“å­˜ + API ä¼˜åŒ– |
| API è°ƒç”¨æ¬¡æ•° | 3-5 | 1 | /api/functions/summary |
| æœç´¢å“åº” | 500ms | 200ms | å‰ç«¯æœç´¢ + ç¼“å­˜ |
| å†å²æŸ¥è¯¢ | - | 300ms | æ–° API ç«¯ç‚¹ |

---

## å¸¸è§é—®é¢˜ (FAQ)

### Q1: æ–°èœå•ä¸Šçº¿åï¼Œæ—§é“¾æ¥ä¼šå¤±æ•ˆå—ï¼Ÿ
**A:** ä¸ä¼šã€‚æ‰€æœ‰æ—§é“¾æ¥éƒ½ä¼šä¿æŒé‡å®šå‘ï¼Œç¡®ä¿ç”¨æˆ·æ— ç¼è¿ç§»ã€‚

### Q2: éœ€è¦è¿ç§»ç°æœ‰æ•°æ®å—ï¼Ÿ
**A:** ä¸éœ€è¦ã€‚æ–°é¡µé¢å’Œæ—§é¡µé¢å…±äº«åç«¯æ•°æ®ï¼Œæ— éœ€è¿ç§»ã€‚

### Q3: ä¼šå½±å“ç°æœ‰çš„ API å—ï¼Ÿ
**A:** ä¸ä¼šã€‚æ‰€æœ‰æ—§ API ä¿æŒå…¼å®¹ï¼Œåªæ˜¯æ–°å¢äº† API ç«¯ç‚¹ã€‚

### Q4: æƒé™æ¨¡å‹å˜åŒ–å¯¹ç°æœ‰æƒé™é…ç½®æœ‰å½±å“å—ï¼Ÿ
**A:** æ–°æƒé™ä¸æ—§æƒé™å…¼å®¹ï¼Œç°æœ‰æƒé™é…ç½®ä¿æŒæœ‰æ•ˆã€‚

### Q5: ä»€ä¹ˆæ—¶å€™èƒ½çœ‹åˆ°æ–°èœå•ï¼Ÿ
**A:** ç¬¬ 1 é˜¶æ®µå®Œæˆåï¼ˆé¢„è®¡ 2-3 å‘¨ï¼‰ï¼Œå¯ä»¥çœ‹åˆ°æ–°èœå•ç»“æ„å’ŒåŸºç¡€é¡µé¢ã€‚

---

## å…³é”®é“¾æ¥

- ğŸ“„ **è¯¦ç»†åˆ†æï¼š** FUNCTION_MANAGEMENT_ARCHITECTURE_ANALYSIS.md
- ğŸ“Š **å¯¹æ¯”å›¾è¡¨ï¼š** FUNCTION_MANAGEMENT_COMPARISON.txt
- ğŸ“‹ **æ‰§è¡Œæ‘˜è¦ï¼š** FUNCTION_MANAGEMENT_EXECUTIVE_SUMMARY.md
- ğŸš€ **è¿™ä»½æŒ‡å—ï¼š** FUNCTION_MANAGEMENT_QUICK_REFERENCE.md

---

## éœ€è¦å¸®åŠ©ï¼Ÿ

1. **ç†è§£ç°çŠ¶ï¼Ÿ** çœ‹å¯¹æ¯”å›¾è¡¨
2. **äº†è§£æ”¹è¿›æ–¹æ¡ˆï¼Ÿ** çœ‹æ‰§è¡Œæ‘˜è¦
3. **æ·±å…¥æŠ€æœ¯ç»†èŠ‚ï¼Ÿ** çœ‹è¯¦ç»†åˆ†æ
4. **å¿«é€ŸæŸ¥é˜…ï¼Ÿ** çœ‹è¿™ä»½å¿«é€Ÿå‚è€ƒ

**è´Ÿè´£äººï¼š** æ¶æ„è¯„å®¡å›¢é˜Ÿ
**æ›´æ–°æ—¶é—´ï¼š** 2024-11-13
**ç‰ˆæœ¬ï¼š** 1.0
